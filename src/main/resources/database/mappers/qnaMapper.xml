<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
  <mapper namespace="com.cw.s4.board.qna.QnaDAO">
  	<select id="getList" resultType="QnaDTO" parameterType="Pager">
  		SELECT * FROM (SELECT ROWNUM R, QA.* FROM 
  		(SELECT * FROM QNA WHERE 
  		<choose>
  			<when test="kind=='title'">title</when>
  			<when test="kind=='contents'">contents</when>
  			<otherwise>writer</otherwise>
  		</choose> 
  		LIKE '%' || #{search} || '%' 
  		ORDER BY NUM DESC) QA) 
  		WHERE R BETWEEN #{startRow} and #{lastRow}
  	</select>
  	
  	<select id="getCount" resultType="Long" parameterType="Pager">
  		SELECT COUNT(NUM) FROM QNA WHERE 
  		<choose>
  			<when test="kind=='title'">title</when>
  			<when test="kind=='contents'">contents</when>
  			<otherwise>writer</otherwise>
  		</choose> 
  		LIKE '%' || #{search} || '%' 
  	</select>
	
  </mapper>